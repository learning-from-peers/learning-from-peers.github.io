<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="LeaP">
  <meta name="keywords" content="Reasoning, open-source, Scaling">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LeaP</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 120 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¦˜</text></svg>">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <!-- Add jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Add Slick Carousel -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <!-- ä¿®æ”¹åçš„åˆå§‹åŒ–ä»£ç  -->

  <style>
    .slider {
      width: 1400px; /* è®¾ç½®è½®æ’­å›¾å®¹å™¨çš„å®½åº¦ */
      height: 600px; /* è®¾ç½®è½®æ’­å›¾å®¹å™¨çš„é«˜åº¦ */
      margin: 0 auto; /* å±…ä¸­æ˜¾ç¤º */
      overflow: hidden; /* éšè—è¶…å‡ºå®¹å™¨çš„å†…å®¹ */
      position: relative; /* ç›¸å¯¹å®šä½ï¼Œä¸ºäº†å®¹å™¨å†…çš„ç»å¯¹å®šä½å…ƒç´ è€Œè®¾ç½® */
    }
    
    .slider img {
      width: auto; /* è‡ªåŠ¨é€‚åº”å®½åº¦ */
      height: 450px; /* é«˜åº¦è‡ªé€‚åº”å®¹å™¨ */
      display: block; /* å—çº§å…ƒç´ æ˜¾ç¤º */
      margin: 0 auto; /* å›¾ç‰‡æ°´å¹³å±…ä¸­ */
    }
    
    /* å¢å¤§å‰åç®­å¤´æŒ‰é’®å¹¶å±…ä¸­ */
    .slick-prev,
    .slick-next {
      display: block; /* å¼ºåˆ¶æ˜¾ç¤ºç®­å¤´ */
      background-color: #ccc; /* æŒ‰é’®èƒŒæ™¯è‰² */
      color: #494242; /* æŒ‰é’®æ–‡å­—é¢œè‰² */
      border-radius: 50%; /* åœ†å½¢æŒ‰é’® */
      position: absolute; /* ç»å¯¹å®šä½ */
      top: 50%; /* å‚ç›´å±…ä¸­ */
      transform: translateY(-50%); /* å‚ç›´å±…ä¸­ */
      cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆæ ·å¼ */
      z-index: 1000; /* ç¡®ä¿åœ¨é¡¶éƒ¨ */
      font-size: 20px; /* æŒ‰é’®æ–‡å­—å¤§å° */
      line-height: 1; /* ç¡®ä¿æ–‡å­—å‚ç›´å±…ä¸­ */
    }
    
    /* è°ƒæ•´å·¦ç®­å¤´ä½ç½® */
    .slick-prev {
      left: 50px; /* å·¦ä¾§ä½ç½® */
    }
    
    /* è°ƒæ•´å³ç®­å¤´ä½ç½® */
    .slick-next {
      right: 50px; /* å³ä¾§ä½ç½® */
    }
    
    .caption {
      text-align: center; /* å±…ä¸­æ˜¾ç¤º */
      margin-top: 10px; /* ä¸Šè¾¹è· */
    }
    .bordered-box {
        padding: 15px;
        border: 2px solid #000000;
        border-radius: 8px;
        margin-top: 20px;
        background-color: #fafafa;
    }
    .prompt-text {
        font-size: 18px;
        line-height: 1.6;
        color: #333;
    }
    .orange-text {
        color: orange;
        font-weight: bold;
    }
    .reflect-text {
        color: #4CAF50;
        font-style: italic;
    }
    .trigger-text {
        color: #8aedff;
        font-weight: bold;
    }
    </style>
  

  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  </head>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Learning from Peers in Reasoning Models</h1>
          <!-- <h2 class="title is-2 publication-title"></h2> -->
          <!-- <h3 class="title is-3 publication-title">(NeurIPS 2024 Spotlight)</h3> -->
          <div class="is-size-5">
            <span class="author-block">
                <a href="https://tongxuluo.github.io/" style="color:#008AD7;font-weight:normal;">Tongxu Luo<sup>1*</sup></a>,
            </span>
            <span class="author-block">
              <a href="https://wenyudu.github.io/" style="color:#008AD7;font-weight:normal;">Wenyu Du<sup>2*</sup></a>,
            </span>
            <span class="author-block">
              <a href="" style="color:#008AD7;font-weight:normal;">Jiaxi Bi<sup>3</sup></a>,
            </span>
            <br>
            <span class="author-block">
              <a href="https://stephen-c.com/" style="color:#008AD7;font-weight:normal;">Stephen Chung<sup>2</sup></a>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=2RRV0PQAAAAJ&hl=en" style="color:#008AD7;font-weight:normal;">Zhengyang Tang<sup>1</sup></a>,
            </span>
            <span class="author-block">
              <a href="https://wabyking.github.io/old.html" style="color:#008AD7;font-weight:normal;">Benyou Wang<sup>1â€ </sup></a>
            </span>
            
          </div>

          <br>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><b style="color:#008AD7; font-weight:normal"></b><sup>1</sup>The Chinese University of Hong Kong, Shenzhen </span>
            <br>
            <span class="author-block"><b style="color:#008AD7; font-weight:normal"></b><sup>2</sup>DualityRL, </span>
            <span class="author-block"><b style="color:#008AD7; font-weight:normal"></b><sup>3</sup>USTB</span>
          </div>

          <div class="is-size-5">
            <span class="author-block"><sup>*</sup>Equal Contributions.</span>
            <span class="author-block"><sup>â€ </sup>Corresponding Author.</span>
          </div>

          <br>
         <!--  <div class="is-size-5 publication-authors">
            <span class="author-block"><b style="color:#e08ba0; font-weight:normal"> <b>In CVPR2023</b> </b></span>
          </div> -->


          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2405.15319" target="_blank"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              
              <span class="link-block">
                <a href="https://github.com/tongxuluo/LeaP" target="_blank" 
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              
              <span class="link-block">
                      <a href="https://huggingface.co/Learning-from-Peers" target="_blank"
                         class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        ğŸ¤—
                      </span>
                      <span>Datasets & Models</span>
                    </a>
                  </span>
              
              <script>
                  window.addEventListener('load', function() {
                    const urls = [
                      'https://bb0eec8976f38a480c.gradio.live',
                      'https://94c50413658b59829f.gradio.live',
                      'https://16440e488436f49d99.gradio.live',
                      'https://02edd560d60615d755.gradio.live',
                    ];
                    const randomIndex = Math.floor(Math.random() * urls.length);
                    const randomURL = urls[randomIndex];
                    document.getElementById('randomLink').href = randomURL;
                  });
                </script>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<div align="center">
  <img src="./images/logo.png" width="384" height="384">
</div>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Self-correction is a key factor in enabling reasoning models to excel in complex reasoning tasks. However, recent studies show that current models frequently become stuck in incorrect paths that are rarely corrected. 
To this end, we design a sequel generation task that measures the accuracy decline when the first chunk of tokens in the responses are fixed to likely lead to an incorrect answer. The significant performance drop observed in DeepSeek-R1-Distill-Qwen-7B, DeepSeek-R1-Distill-Qwen-14B, and QwQ-32B highlights their limited ability to recover from a poor starting point (prelude). 
To enhance self-correction for reasoning models, we enable them to learn from peers (LeaP) during parallel generation. Concretely, for every \( T \) tokens, each generation summarizes its reasoning path and shares it with others via a routing mechanism. This allows reasoning models to reference their peers' paths during their own reasoning processes. 
We evaluate LeaP during both the inference phase (LeaP-I) and the training phase (LeaP-T), observing notable performance improvements. QwQ-32B in LeaP-I surpasses baselines on AIME2024, 2025, AIMO25, and GPQA Diamond by 4.61. It even outperforms R1-671B across AIME2024, 2025, and AIMO25, with an average improvement of 3.3. Moreover, LeaP-T 7B matches the performance of Distill 14B in AIME2024. 
Further ablation studies reveal that communication is most effective when it occurs in the early phases. As a result, we propose LeaP-S, which communicates only once during the initial phase, facilitating comparison with single-run performance. We also conduct a thorough analysis and discussion, demonstrating that LeaP significantly mitigates performance drops in sequel generation. This suggests that peer communication can expand the search space, complementing the limitations by pure sequential search of reasoning models.
</b>
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
    <br>
    <br>
    <!-- Paper Model. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-six-fifths">
        <h2 class="title is-3">Learning from Peers Reasoning</h2>
        <div class="content has-text-justified">
          <p>
            <b>Our method facilitates the integration of multiple LeaP blocks into the reasoning process, allowing paths to learn from one another. During generation, after every $T$ tokens, we insert a LeaP block, which includes a summary generated by the current path, along with summaries from other peers</b>:
          </p>
        </div>  
        <img id="model" width="80%" src="images/overview.png">
        <h3 class="subtitle has-text-centered">
          <p style="font-family:Times New Roman"><b>The illustration of (a) Independent Reasoning and (b) the proposed method, Learning from Peers (LeaP). In independent reasoning, multiple paths are generated independently in parallel. In contrast, LeaP inserts a LeaP block into each reasoning block, encouraging the model to learn from its peers.</b></p>
        </h3>
      </div>
    </div>
    <h3 class="title is-3">The LeaP Block</h3>
    <div class="container">
      <div class="bordered-box"> <!-- This is the added border around the prompt -->
          <div class="prompt-text">
              <p> <span, class="prompt-text">...</span> </p>
              <p<span class="trigger-text">Alright, letâ€™s take a step back and summarize what weâ€™ve figured out so far.</span></p>
              <p><span, class="prompt-text">&lt;summarize&gt; </span><span class="orange-text">In short, my current conclusions are that</span> <span class="prompt-text">{Generated summary}</span> <span, class="prompt-text">&lt;/summarize&gt; </span></p>
              <p class="peer-comments"><span class="reflect-text">Hmm, it seems that my peers have given me some comments, so let me check if anyoneâ€™s conclusions are different from mine before I continue my own reasoning.</span></p>
              <p class="prompt-text">{Selected summaries from peers}</p>
              <p> <span, class="prompt-text">...</span> </p>
          </div>
      </div>
  </div>
    <!--/ Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-six-fifths">
        <h3 class="title is-3">Illustrations</h3>
        <div class="slider">
          <div>
            <img src="images/gif/g_stack.gif" alt="Stack GIF">
            <p class="caption">Illustration of the $G_{\text{stack}}$ operator</p>
          </div>
          <div>
            <img src="images/gif/g_split.gif" alt="Split GIF">
            <p class="caption">Illustration of the $G_{\text{split}}$ operator</p>
          </div>
          <div>
            <img src="images/gif/g_learn.gif" alt="Learn GIF">
            <p class="caption">Illustration of the $G_{\text{learn}}$ operator</p>
          </div>
          <div>
            <img src="images/gif/g_zero.gif" alt="Zero GIF">
            <p class="caption">Illustration of the $G_{\text{zero}}$ operator</p>
          </div>
          <div>
            <img src="images/gif/g_mask.gif" alt="Mask GIF">
            <p class="caption">Illustration of the $G_{\text{random}}$ operator</p>
          </div>
        </div>
      </div>
    </div>
     -->
    <!-- <div class="hero-body">
      <div class="container">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item g_stack">
            <img id="g_stack" width="20%" src="images/gif/g_stack.gif">
          </div>
          <div class="item g_split">
            <img id="g_split" width="20%" src="images/gif/g_split.gif">
          </div>
          <div class="item g_learn">
            <img id="g_learn" width="20%" src="images/gif/g_learn.gif">
          </div>
          
        </div>
      </div>
    </div> -->
  </div>
</section>

<script>
  $(document).ready(function(){
    $('.slider').slick({
      dots: true, // æ˜¾ç¤ºå¯¼èˆªç‚¹
      infinite: true, // æ— é™å¾ªç¯
      speed: 500, // åˆ‡æ¢é€Ÿåº¦
      slidesToShow: 2, // æ¯æ¬¡æ˜¾ç¤ºçš„å¹»ç¯ç‰‡æ•°é‡
      slidesToScroll: 1, // æ¯æ¬¡æ»šåŠ¨çš„å¹»ç¯ç‰‡æ•°é‡
      prevArrow: '<button type="button" class="slick-prev">Previous</button>', // ä¸Šä¸€ä¸ªç®­å¤´
      nextArrow: '<button type="button" class="slick-next">Next</button>', // ä¸‹ä¸€ä¸ªç®­å¤´
      adaptiveHeight: true, // è‡ªé€‚åº”é«˜åº¦
      responsive: [
        {
          breakpoint: 768, // æ–­ç‚¹å®½åº¦
          settings: {
            slidesToShow: 1, // åœ¨æ–­ç‚¹ä¸‹æ˜¾ç¤ºçš„å¹»ç¯ç‰‡æ•°é‡
            slidesToScroll: 1 // åœ¨æ–­ç‚¹ä¸‹æ»šåŠ¨çš„å¹»ç¯ç‰‡æ•°é‡
          }
        }
      ]
    });
  });
</script>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Main Results</h2>
    <div class="columns is-centered has-text-centered">
      <div class="column is-six-fifths">
        <img id="model" width="80%" src="images/results.jpg">
        <h3 class="subtitle has-text-centered">
          <p style="font-family:Times New Roman"><b>We evaluate the baseline and our LeaP with three types of routers on AIME 2024 and 2025, AIMO 2025 and GPQA Diamond. All of our methods outperform baseline significantly. Since DeepSeek-R1-671B does not have an official AIMO 2025 score, we evaluate it on the official website by repeating the inference four times. The R1-7B and R1-14B represent the 7B and 14B versions of DeepSeek-R1-Distill-Qwen.</b></p>
        </h3>
      </div>
    </div>
    <div class="columns is-centered">

      <!-- 3B. -->
      <!-- <div class="column">
        <div class="content">
          <h2 class="title is-4">3B</h2>
          <p>
            Training 3B LLMs with 300B tokens. $G_\text{stack}$ significantly outperforms scratch in loss.
          </p>
          <div class="item item-chair-tp">
            <img src="./images/loss/3B.jpg" alt="3B-sp" id="3B-sp" height="100%">
          </div>
        </div>
      </div> -->
      <!--/ 3B. -->

      <!-- 7B. -->
      <!-- <div class="column">
        <h2 class="title is-4">7B</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              Training 7B LLMs with 300B tokens. $G_\text{stack}$ significantly outperforms scratch in loss.
            </p>
            <div class="item item-chair-tp">
              <img src="./images/loss/7B.jpg" alt="7B-sp" id="7B-sp" height="100%">
            </div>
          </div>
        </div>
      </div>
    </div> -->
    <!--/ 7B. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3">TODO</h2>
    <ul>
      <li><input type="checkbox" checked disabled> Open source our code, datasets and V1 models -- 2025.5.10</li>
      <li><input type="checkbox" disabled> Publish our LeaP-R1 models trained by RL -- 2025.8</li>
      <!-- <li><input type="checkbox" disabled> Refactor our code to make it more concise -- 2024.7</li> -->
    </ul>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{du2024stacking,
      title={Stacking Your Transformers: A Closer Look at Model Growth for Efficient LLM Pre-Training},
      author={Du, Wenyu and Luo, Tongxu and Qiu, Zihan and Huang, Zeyu and Shen, Yikang and Cheng, Reynold and Guo, Yike and Fu, Jie},
      journal={arXiv preprint arXiv:2405.15319},
      year={2024}
    }
</code></pre>
  </div>
</section>




<section class="section" id="Acknowledgement">
  <div class="container is-max-desktop content">
    <h2 class="title">Acknowledgement</h2>
    <p>
      This website is adapted from <a
      href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>, licensed under a <a rel="license"
                                          href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
      Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </div>
</section>

</body>
</html>
